import{c as Be,a as pe,f as Re,d as H,u as Oe,b as Ae,r as U,t as Ie,e as Ue,g as ye,h as _,i as Le,j as Me,k as de,l as E,V as $e,m as Fe,n as De,N as be,o as Ve,T as Pe,w as Ee,p as je,q as ze,s as Ne,v as qe,x as He,y as Ke,z as q,A as Ze,B as p,C as S,D as o,E as Je,F as P,G as me,H as ve,I as Ce,J as d,K as we,L as h,M as fe,O as F,_ as B,P as C,Q as J,R as $,S as We,U as ee,W as he,X as ke,Y as Qe,Z as _e,$ as Ge,a0 as W,a1 as Xe,a2 as Ye,a3 as et,a4 as tt,a5 as nt,a6 as ot,a7 as ge,a8 as at,a9 as xe}from"./index-b4a6e4c0.js";function lt(e){return e.map(Te)}function Te(e){var l,n;return typeof e=="string"?{label:e,value:e}:e.type==="group"?{type:"group",label:(l=e.label)!==null&&l!==void 0?l:e.name,value:(n=e.value)!==null&&n!==void 0?n:e.name,key:e.key||e.name,children:e.children.map(r=>Te(r))}:e}const st=Be([pe("auto-complete",`
 z-index: auto;
 position: relative;
 display: inline-flex;
 width: 100%;
 `),pe("auto-complete-menu",`
 margin: 4px 0;
 box-shadow: var(--n-menu-box-shadow);
 `,[Re({originalTransition:"background-color .3s var(--n-bezier), box-shadow .3s var(--n-bezier)"})])]),rt=Object.assign(Object.assign({},ye.props),{to:de.propTo,menuProps:Object,bordered:{type:Boolean,default:void 0},clearable:{type:Boolean,default:void 0},defaultValue:{type:String,default:null},loading:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},placeholder:String,placement:{type:String,default:"bottom-start"},value:String,blurAfterSelect:Boolean,clearAfterSelect:Boolean,getShow:Function,inputProps:Object,renderOption:Function,renderLabel:Function,size:String,options:{type:Array,default:()=>[]},zIndex:Number,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onSelect:[Function,Array],onBlur:[Function,Array],onFocus:[Function,Array],onInput:[Function,Array]}),it=H({name:"AutoComplete",props:rt,setup(e){const{mergedBorderedRef:l,namespaceRef:n,mergedClsPrefixRef:u,inlineThemeDisabled:r}=Oe(e),i=Ae(e),{mergedSizeRef:b,mergedDisabledRef:v,mergedStatusRef:R}=i,g=U(null),x=U(null),j=U(e.defaultValue),D=Ie(e,"value"),M=Ue(D,j),L=U(!1),z=U(!1),w=ye("AutoComplete","-auto-complete",st,Ne,e,u),O=_(()=>lt(e.options)),Q=_(()=>{const{getShow:t}=e;return t?t(M.value||""):!!M.value}),A=_(()=>Q.value&&L.value&&!!O.value.length),k=_(()=>qe(O.value,Ke("value","children")));function N(t){const{"onUpdate:value":s,onUpdateValue:m,onInput:I}=e,{nTriggerFormInput:T,nTriggerFormChange:V}=i;m&&q(m,t),s&&q(s,t),I&&q(I,t),j.value=t,T(),V()}function G(t){const{onSelect:s}=e,{nTriggerFormInput:m,nTriggerFormChange:I}=i;s&&q(s,t),m(),I()}function K(t){const{onBlur:s}=e,{nTriggerFormBlur:m}=i;s&&q(s,t),m()}function te(t){const{onFocus:s}=e,{nTriggerFormFocus:m}=i;s&&q(s,t),m()}function ne(){z.value=!0}function X(){window.setTimeout(()=>{z.value=!1},0)}function oe(t){var s,m,I;switch(t.key){case"Enter":if(!z.value){const T=(s=x.value)===null||s===void 0?void 0:s.getPendingTmNode();T&&(Y(T.rawNode),t.preventDefault())}break;case"ArrowDown":(m=x.value)===null||m===void 0||m.next();break;case"ArrowUp":(I=x.value)===null||I===void 0||I.prev();break}}function Y(t){(t==null?void 0:t.value)!==void 0&&(G(t.value),e.clearAfterSelect?N(null):t.label!==void 0&&N(t.label),L.value=!1,e.blurAfterSelect&&ue())}function ae(){N(null)}function le(t){L.value=!0,te(t)}function se(t){L.value=!1,K(t)}function re(t){L.value=!0,N(t)}function ie(t){Y(t.rawNode)}function ce(t){var s;!((s=g.value)===null||s===void 0)&&s.contains(He(t))||(L.value=!1)}function ue(){var t,s;!((t=g.value)===null||t===void 0)&&t.contains(document.activeElement)&&((s=document.activeElement)===null||s===void 0||s.blur())}const a=_(()=>{const{common:{cubicBezierEaseInOut:t},self:{menuBoxShadow:s}}=w.value;return{"--n-menu-box-shadow":s,"--n-bezier":t}}),c=r?Le("auto-complete",void 0,a,e):void 0,f=U(null),y={focus:()=>{var t;(t=f.value)===null||t===void 0||t.focus()},blur:()=>{var t;(t=f.value)===null||t===void 0||t.blur()}};return{focus:y.focus,blur:y.blur,inputInstRef:f,uncontrolledValue:j,mergedValue:M,isMounted:Me(),adjustedTo:de(e),menuInstRef:x,triggerElRef:g,treeMate:k,mergedSize:b,mergedDisabled:v,active:A,mergedStatus:R,handleClear:ae,handleFocus:le,handleBlur:se,handleInput:re,handleToggle:ie,handleClickOutsideMenu:ce,handleCompositionStart:ne,handleCompositionEnd:X,handleKeyDown:oe,mergedTheme:w,cssVars:r?void 0:a,themeClass:c==null?void 0:c.themeClass,onRender:c==null?void 0:c.onRender,mergedBordered:l,namespace:n,mergedClsPrefix:u}},render(){const{mergedClsPrefix:e}=this;return E("div",{class:`${e}-auto-complete`,ref:"triggerElRef",onKeydown:this.handleKeyDown,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd},E($e,null,{default:()=>[E(Fe,null,{default:()=>{if(this.$slots.default)return De(this.$slots,"default",{handleInput:this.handleInput,handleFocus:this.handleFocus,handleBlur:this.handleBlur,value:this.mergedValue});const{mergedTheme:n}=this;return E(be,{ref:"inputInstRef",status:this.mergedStatus,theme:n.peers.Input,themeOverrides:n.peerOverrides.Input,bordered:this.mergedBordered,value:this.mergedValue,placeholder:this.placeholder,size:this.mergedSize,disabled:this.mergedDisabled,clearable:this.clearable,loading:this.loading,inputProps:this.inputProps,onClear:this.handleClear,onFocus:this.handleFocus,onUpdateValue:this.handleInput,onBlur:this.handleBlur},{suffix:()=>{var u,r;return(r=(u=this.$slots).suffix)===null||r===void 0?void 0:r.call(u)},prefix:()=>{var u,r;return(r=(u=this.$slots).prefix)===null||r===void 0?void 0:r.call(u)}})}}),E(Ve,{show:this.active,to:this.adjustedTo,containerClass:this.namespace,zIndex:this.zIndex,teleportDisabled:this.adjustedTo===de.tdkey,placement:this.placement,width:"target"},{default:()=>E(Pe,{name:"fade-in-scale-up-transition",appear:this.isMounted},{default:()=>{var l;if((l=this.onRender)===null||l===void 0||l.call(this),!this.active)return null;const{menuProps:n}=this;return Ee(E(ze,Object.assign({},n,{clsPrefix:e,ref:"menuInstRef",theme:this.mergedTheme.peers.InternalSelectMenu,themeOverrides:this.mergedTheme.peerOverrides.InternalSelectMenu,"auto-pending":!0,class:[`${e}-auto-complete-menu`,this.themeClass,n==null?void 0:n.class],style:[n==null?void 0:n.style,this.cssVars],treeMate:this.treeMate,multiple:!1,renderLabel:this.renderLabel,renderOption:this.renderOption,size:"medium",onToggle:this.handleToggle})),[[je,this.handleClickOutsideMenu,void 0,{capture:!0}]])}})})]}))}}),ct={key:1,class:"text-[28px] dark:text-white"},ut=d("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32","aria-hidden":"true",width:"1em",height:"1em"},[d("path",{d:"M29.71,13.09A8.09,8.09,0,0,0,20.34,2.68a8.08,8.08,0,0,0-13.7,2.9A8.08,8.08,0,0,0,2.3,18.9,8,8,0,0,0,3,25.45a8.08,8.08,0,0,0,8.69,3.87,8,8,0,0,0,6,2.68,8.09,8.09,0,0,0,7.7-5.61,8,8,0,0,0,5.33-3.86A8.09,8.09,0,0,0,29.71,13.09Zm-12,16.82a6,6,0,0,1-3.84-1.39l.19-.11,6.37-3.68a1,1,0,0,0,.53-.91v-9l2.69,1.56a.08.08,0,0,1,.05.07v7.44A6,6,0,0,1,17.68,29.91ZM4.8,24.41a6,6,0,0,1-.71-4l.19.11,6.37,3.68a1,1,0,0,0,1,0l7.79-4.49V22.8a.09.09,0,0,1,0,.08L13,26.6A6,6,0,0,1,4.8,24.41ZM3.12,10.53A6,6,0,0,1,6.28,7.9v7.57a1,1,0,0,0,.51.9l7.75,4.47L11.85,22.4a.14.14,0,0,1-.09,0L5.32,18.68a6,6,0,0,1-2.2-8.18Zm22.13,5.14-7.78-4.52L20.16,9.6a.08.08,0,0,1,.09,0l6.44,3.72a6,6,0,0,1-.9,10.81V16.56A1.06,1.06,0,0,0,25.25,15.67Zm2.68-4-.19-.12-6.36-3.7a1,1,0,0,0-1.05,0l-7.78,4.49V9.2a.09.09,0,0,1,0-.09L19,5.4a6,6,0,0,1,8.91,6.21ZM11.08,17.15,8.38,15.6a.14.14,0,0,1-.05-.08V8.1a6,6,0,0,1,9.84-4.61L18,3.6,11.61,7.28a1,1,0,0,0-.53.91ZM12.54,14,16,12l3.47,2v4L16,20l-3.47-2Z",fill:"currentColor"})],-1),dt=[ut],ft=H({__name:"Avatar",props:{image:{type:Boolean}},setup(e){const l=Ze(),n=_(()=>l.userInfo.avatar);return(u,r)=>e.image?(p(),S(Ce,{key:0},[o(Je)(o(n))&&o(n).length>0?(p(),P(o(ve),{key:0,src:o(n),"fallback-src":o(me)},null,8,["src","fallback-src"])):(p(),P(o(ve),{key:1,round:"",src:o(me)},null,8,["src"]))],64)):(p(),S("span",ct,dt))}}),ht={key:0,class:"dark:text-white w-[4px] h-[20px] block animate-blink"},pt=["innerHTML"],mt=["textContent"],vt=H({__name:"Text",props:{inversion:{type:Boolean},error:{type:Boolean},text:null,loading:{type:Boolean}},setup(e,{expose:l}){const n=e,{isMobile:u}=we(),r=U(),i=new MarkdownIt({linkify:!0,highlight(g,x){if(!!(x&&hljs.getLanguage(x))){const D=x??"";return R(hljs.highlight(D,g,!0).value,D)}return R(hljs.highlightAuto(g).value,"")}});i.use(mdKatex,{blockClass:"katexmath-block rounded-md p-[10px]",errorColor:" #cc0000"});const b=_(()=>["text-wrap","min-w-[20px]","rounded-md",u.value?"p-2":"px-3 py-2",n.inversion?"bg-[#d2f9d1]":"bg-[#f4f6f8]",n.inversion?"dark:bg-[#a1dc95]":"dark:bg-[#1e1e20]",{"text-red-500":n.error}]),v=_(()=>{const g=n.text??"";return n.inversion?g:i.render(g)});function R(g,x){return`<pre class="code-block-wrapper"><div class="code-block-header"><span class="code-block-header__lang">${x}</span><span class="code-block-header__copy">${h("chat.copyCode")}</span></div><code class="hljs code-block-body ${x}">${g}</code></pre>`}return l({textRef:r}),(g,x)=>(p(),S("div",{class:F(["text-black",o(b)])},[e.loading?(p(),S("span",ht)):(p(),S("div",{key:1,ref_key:"textRef",ref:r,class:"leading-relaxed break-words"},[e.inversion?(p(),S("div",{key:1,class:"whitespace-pre-wrap",textContent:fe(o(v))},null,8,mt)):(p(),S("div",{key:0,class:"markdown-body",innerHTML:o(v)},null,8,pt))],512))],2))}});function Se(e){const l={origin:!0,...e};let n;l.origin?n=document.createElement("textarea"):n=document.createElement("input"),n.setAttribute("readonly","readonly"),n.value=l.text,document.body.appendChild(n),n.select(),document.execCommand("copy")&&document.execCommand("copy"),document.body.removeChild(n)}const gt=()=>({iconRender:l=>{const{color:n,fontSize:u,icon:r}=l,i={};return n&&(i.color=n),u&&(i.fontSize=`${u}px`),r||window.console.warn("iconRender: icon is required"),()=>E(B,{icon:r,style:i})}}),xt={class:"flex flex-col"},yt={class:"transition text-neutral-300 hover:text-neutral-800 dark:hover:text-neutral-200"},bt=H({__name:"index",props:{dateTime:null,text:null,inversion:{type:Boolean},error:{type:Boolean},loading:{type:Boolean}},emits:["regenerate","delete"],setup(e,{emit:l}){const n=e,{iconRender:u}=gt(),r=U(),i=[{label:h("chat.copy"),key:"copyText",icon:u({icon:"ri:file-copy-2-line"})},{label:h("common.delete"),key:"delete",icon:u({icon:"ri:delete-bin-line"})}];function b(R){switch(R){case"copyText":Se({text:n.text??""});return;case"delete":l("delete")}}function v(){l("regenerate")}return(R,g)=>(p(),S("div",{class:F(["flex w-full mb-6 overflow-hidden",[{"flex-row-reverse":e.inversion}]])},[d("div",{class:F(["flex items-center justify-center flex-shrink-0 h-8 overflow-hidden rounded-full basis-8",[e.inversion?"ml-2":"mr-2"]])},[C(ft,{image:e.inversion},null,8,["image"])],2),d("div",{class:F(["overflow-hidden text-sm",[e.inversion?"items-end":"items-start"]])},[d("p",{class:F(["text-xs text-[#b4bbc4]",[e.inversion?"text-right":"text-left"]])},fe(e.dateTime),3),d("div",{class:F(["flex items-end gap-1 mt-2",[e.inversion?"flex-row-reverse":"flex-row"]])},[C(vt,{ref_key:"textRef",ref:r,inversion:e.inversion,error:e.error,text:e.text,loading:e.loading},null,8,["inversion","error","text","loading"]),d("div",xt,[e.inversion?J("",!0):(p(),S("button",{key:0,class:"mb-2 transition text-neutral-300 hover:text-neutral-800 dark:hover:text-neutral-300",onClick:v},[C(o(B),{icon:"ri:restart-line"})])),C(o(We),{placement:e.inversion?"left":"right",options:i,onSelect:b},{default:$(()=>[d("button",yt,[C(o(B),{icon:"ri:more-2-fill"})])]),_:1},8,["placement"])])],2)],2)],2))}});function Ct(){const e=U(null);return{scrollRef:e,scrollToBottom:async()=>{await ee(),e.value&&(e.value.scrollTop=e.value.scrollHeight)},scrollToTop:async()=>{await ee(),e.value&&(e.value.scrollTop=0)},scrollToBottomIfAtBottom:async()=>{await ee(),e.value&&e.value.scrollHeight-e.value.scrollTop-e.value.clientHeight<=50&&(e.value.scrollTop=e.value.scrollHeight)}}}function wt(){const e=he();return{addChat:(i,b)=>{e.addChatByUuid(i,b)},updateChat:(i,b,v)=>{e.updateChatByUuid(i,b,v)},updateChatSome:(i,b,v)=>{e.updateChatSomeByUuid(i,b,v)},getChatByUuidAndIndex:(i,b)=>e.getChatByUuidAndIndex(i,b)}}function kt(){function e(){document.querySelectorAll(".code-block-wrapper").forEach(n=>{const u=n.querySelector(".code-block-header__copy"),r=n.querySelector(".code-block-body");u&&r&&u.addEventListener("click",()=>{var i;(i=navigator.clipboard)!=null&&i.writeText?navigator.clipboard.writeText(r.textContent??""):Se({text:r.textContent??"",origin:!0})})})}ke(()=>e()),Qe(()=>e())}function _t(){const e=_e(),l=U(!0);function n(){l.value=!l.value,l.value?e.success(h("chat.turnOnContext")):e.warning(h("chat.turnOffContext"))}return{usingContext:l,toggleUsingContext:n}}const Tt={class:"sticky top-0 left-0 right-0 z-30 border-b dark:border-neutral-800 bg-white/80 dark:bg-black/20 backdrop-blur"},St={class:"relative flex items-center justify-between min-w-0 overflow-hidden h-14"},Bt={class:"flex items-center"},Rt={class:"flex items-center space-x-2"},Ot={class:"text-xl text-[#4f555e] dark:text-white"},At=H({__name:"index",props:{usingContext:{type:Boolean}},emits:["export","toggleUsingContext"],setup(e,{emit:l}){const n=Ge(),u=he(),r=_(()=>n.siderCollapsed),i=_(()=>u.getChatHistoryByCurrentActive);function b(){n.setSiderCollapsed(!r.value)}function v(){const x=document.querySelector("#scrollRef");x&&ee(()=>x.scrollTop=0)}function R(){l("export")}function g(){l("toggleUsingContext")}return(x,j)=>{var D;return p(),S("header",Tt,[d("div",St,[d("div",Bt,[d("button",{class:"flex items-center justify-center w-11 h-11",onClick:b},[o(r)?(p(),P(o(B),{key:0,class:"text-2xl",icon:"ri:align-justify"})):(p(),P(o(B),{key:1,class:"text-2xl",icon:"ri:align-right"}))])]),d("h1",{class:"flex-1 px-4 pr-6 overflow-hidden cursor-pointer select-none text-ellipsis whitespace-nowrap",onDblclick:v},fe(((D=o(i))==null?void 0:D.title)??""),33),d("div",Rt,[C(o(W),{onClick:g},{default:$(()=>[d("span",{class:F(["text-xl",{"text-[#4b9e5f]":e.usingContext,"text-[#a8071a]":!e.usingContext}])},[C(o(B),{icon:"ri:chat-history-line"})],2)]),_:1}),C(o(W),{onClick:R},{default:$(()=>[d("span",Ot,[C(o(B),{icon:"ri:download-2-line"})])]),_:1})])])])}}}),It={class:"flex flex-col w-full h-full"},Ut={class:"flex-1 overflow-hidden"},Lt={key:0,class:"flex items-center justify-center mt-4 text-center text-neutral-300"},Mt=d("span",null,"欢迎使用chatgpt~",-1),$t={key:1},Ft={class:"sticky bottom-0 left-0 flex justify-center"},Dt={class:"w-full max-w-screen-xl m-auto"},Vt={class:"flex items-center justify-between space-x-2"},Pt={class:"text-xl text-[#4f555e] dark:text-white"},Et={class:"text-xl text-[#4f555e] dark:text-white"},jt={class:"dark:text-black"},Nt=H({__name:"index",setup(e){let l=new AbortController;const n=!1,u=ot(),r=Xe(),i=_e(),b=he();kt();const{isMobile:v}=we(),{addChat:R,updateChat:g,updateChatSome:x,getChatByUuidAndIndex:j}=wt(),{scrollRef:D,scrollToBottom:M}=Ct(),{usingContext:L,toggleUsingContext:z}=_t(),{uuid:w}=u.params,O=_(()=>b.getChatByUuid(+w)),Q=_(()=>O.value.filter(a=>!a.inversion&&!a.error)),A=U(""),k=U(!1),N=Ye(),{promptList:G}=et(N);function K(){te()}async function te(){var y;let a=A.value;if(k.value||!a||a.trim()==="")return;l=new AbortController,R(+w,{dateTime:new Date().toLocaleString(),text:a,inversion:!0,error:!1,conversationOptions:null,requestOptions:{prompt:a,options:null}}),M(),k.value=!0,A.value="";let c={};const f=(y=Q.value[Q.value.length-1])==null?void 0:y.conversationOptions;console.log(f),f&&L.value&&(c={...f}),R(+w,{dateTime:new Date().toLocaleString(),text:"",loading:!0,inversion:!1,error:!1,conversationOptions:null,requestOptions:{prompt:a,options:{...c}}}),M();try{await(async()=>{await ge({prompt:a,options:c,signal:l.signal,onDownloadProgress:async({event:s})=>{const m=s.target,{responseText:I}=m,T=I.split("&KFw6loC9Qvy&");try{const V=JSON.parse(T[0]),Z=T[2]&&JSON.parse(T[2]);g(+w,O.value.length-1,{dateTime:new Date().toLocaleString(),text:T[1]||"",inversion:!1,error:!1,loading:!1,conversationOptions:{conversationId:V.conversationId,parentMessageId:V.id},requestOptions:{prompt:a,options:{...c}}}),n&&Z&&Z.detail.choices[0].finish_reason,M()}catch{}}})})()}catch(t){const s=(t==null?void 0:t.message)??h("common.wrong");if(t.message==="canceled"){x(+w,O.value.length-1,{loading:!1}),M();return}const m=j(+w,O.value.length-1);if(m!=null&&m.text&&m.text!==""){x(+w,O.value.length-1,{text:`${m.text}
[${s}]`,error:!1,loading:!1});return}g(+w,O.value.length-1,{dateTime:new Date().toLocaleString(),text:s,inversion:!1,error:!0,loading:!1,conversationOptions:null,requestOptions:{prompt:a,options:{...c}}}),M()}finally{k.value=!1}}async function ne(a){if(k.value)return;l=new AbortController;const{requestOptions:c}=O.value[a];let f=(c==null?void 0:c.prompt)??"",y={};c.options&&(y={...c.options}),k.value=!0,g(+w,a,{dateTime:new Date().toLocaleString(),text:"",inversion:!1,error:!1,loading:!0,conversationOptions:null,requestOptions:{prompt:f,...y}});try{await(async()=>{await ge({prompt:f,options:y,signal:l.signal,onDownloadProgress:({event:s})=>{const m=s.target,{responseText:I}=m,T=I.split("&KFw6loC9Qvy&");try{const V=JSON.parse(T[0]),Z=T[2]&&JSON.parse(T[2]);g(+w,a,{dateTime:new Date().toLocaleString(),text:T[1]||"",inversion:!1,error:!1,loading:!1,conversationOptions:{conversationId:V.conversationId,parentMessageId:V.id},requestOptions:{prompt:f,...y}}),n&&Z&&Z.detail.choices[0].finish_reason}catch{}}})})()}catch(t){if(t.message==="canceled"){x(+w,a,{loading:!1});return}const s=(t==null?void 0:t.message)??h("common.wrong");g(+w,a,{dateTime:new Date().toLocaleString(),text:s,inversion:!1,error:!0,loading:!1,conversationOptions:null,requestOptions:{prompt:f,...y}})}finally{k.value=!1}}function X(){if(k.value)return;const a=r.warning({title:h("chat.exportImage"),content:h("chat.exportImageConfirm"),positiveText:h("common.yes"),negativeText:h("common.no"),onPositiveClick:async()=>{try{a.loading=!0;const c=document.getElementById("image-wrapper"),y=(await html2canvas(c,{useCORS:!0})).toDataURL("image/png"),t=document.createElement("a");t.style.display="none",t.href=y,t.setAttribute("download","chat-shot.png"),typeof t.download>"u"&&t.setAttribute("target","_blank"),document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(y),a.loading=!1,i.success(h("chat.exportSuccess")),Promise.resolve()}catch{i.error(h("chat.exportFailed"))}finally{a.loading=!1}}})}function oe(a){k.value||r.warning({title:h("chat.deleteMessage"),content:h("chat.deleteMessageConfirm"),positiveText:h("common.yes"),negativeText:h("common.no"),onPositiveClick:()=>{b.deleteChatByUuid(+w,a)}})}function Y(){k.value||r.warning({title:h("chat.clearChat"),content:h("chat.clearChatConfirm"),positiveText:h("common.yes"),negativeText:h("common.no"),onPositiveClick:()=>{b.clearChatByUuid(+w)}})}function ae(a){v.value?a.key==="Enter"&&a.ctrlKey&&(a.preventDefault(),K()):a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),K())}function le(){k.value&&(l.abort(),k.value=!1)}const se=_(()=>A.value.startsWith("/")?G.value.filter(a=>a.key.toLowerCase().includes(A.value.substring(1).toLowerCase())).map(a=>({label:a.value,value:a.value})):[]),re=a=>{for(const c of G.value)if(c.value===a.label)return[c.key];return[]},ie=_(()=>v.value?h("chat.placeholderMobile"):h("chat.placeholder")),ce=_(()=>k.value||!A.value||A.value.trim()===""),ue=_(()=>{let a=["p-4"];return v.value&&(a=["sticky","left-0","bottom-0","right-0","p-2","pr-3","overflow-hidden"]),a});return ke(()=>{M()}),tt(()=>{k.value&&l.abort()}),(a,c)=>(p(),S("div",It,[o(v)?(p(),P(At,{key:0,"using-context":o(L),onExport:X,onToggleUsingContext:o(z)},null,8,["using-context","onToggleUsingContext"])):J("",!0),d("main",Ut,[d("div",{id:"scrollRef",ref_key:"scrollRef",ref:D,class:"h-full overflow-hidden overflow-y-auto"},[d("div",{id:"image-wrapper",class:F(["w-full max-w-screen-xl m-auto dark:bg-[#101014]",[o(v)?"p-2":"p-4"]])},[o(O).length?(p(),S("div",$t,[(p(!0),S(Ce,null,nt(o(O),(f,y)=>(p(),P(o(bt),{key:y,"date-time":f.dateTime,text:f.text,inversion:f.inversion,error:f.error,loading:f.loading,onRegenerate:t=>ne(y),onDelete:t=>oe(y)},null,8,["date-time","text","inversion","error","loading","onRegenerate","onDelete"]))),128)),d("div",Ft,[k.value?(p(),P(o(xe),{key:0,type:"warning",onClick:le},{icon:$(()=>[C(o(B),{icon:"ri:stop-circle-line"})]),default:$(()=>[at(" 暂停 ")]),_:1})):J("",!0)])])):(p(),S("div",Lt,[C(o(B),{icon:"ri:bubble-chart-fill",class:"mr-2 text-3xl"}),Mt]))],2)],512)]),d("footer",{class:F(o(ue))},[d("div",Dt,[d("div",Vt,[C(o(W),{onClick:Y},{default:$(()=>[d("span",Pt,[C(o(B),{icon:"ri:delete-bin-line"})])]),_:1}),o(v)?J("",!0):(p(),P(o(W),{key:0,onClick:X},{default:$(()=>[d("span",Et,[C(o(B),{icon:"ri:download-2-line"})])]),_:1})),o(v)?J("",!0):(p(),P(o(W),{key:1,onClick:o(z)},{default:$(()=>[d("span",{class:F(["text-xl",{"text-[#4b9e5f]":o(L),"text-[#a8071a]":!o(L)}])},[C(o(B),{icon:"ri:chat-history-line"})],2)]),_:1},8,["onClick"])),C(o(it),{value:A.value,"onUpdate:value":c[1]||(c[1]=f=>A.value=f),options:o(se),"render-label":re},{default:$(({handleInput:f,handleBlur:y,handleFocus:t})=>[C(o(be),{value:A.value,"onUpdate:value":c[0]||(c[0]=s=>A.value=s),type:"textarea",placeholder:o(ie),autosize:{minRows:1,maxRows:o(v)?4:8},onInput:f,onFocus:t,onBlur:y,onKeypress:ae},null,8,["value","placeholder","autosize","onInput","onFocus","onBlur"])]),_:1},8,["value","options"]),C(o(xe),{type:"primary",disabled:o(ce),onClick:K},{icon:$(()=>[d("span",jt,[C(o(B),{icon:"ri:send-plane-fill"})])]),_:1},8,["disabled"])])])],2)]))}});export{Nt as default};
